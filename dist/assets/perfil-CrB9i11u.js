import{m as h}from"./main-DbTm04-e.js";document.addEventListener("DOMContentLoaded",()=>{h();const m=document.querySelector(".btn-alterar-dados"),u=document.querySelector(".btn-cancelar-edicao"),s=["matricula","curso","email","cpf","sexo","nascimento","telefone","endereco"],l=JSON.parse(localStorage.getItem("usuarioLogado"));l?(localStorage.setItem("nome",l.nome||""),localStorage.setItem("matricula",l.matricula||""),localStorage.setItem("email",l.email||""),localStorage.setItem("curso",l.curso||""),localStorage.setItem("cpf",l.cpf||""),localStorage.setItem("sexo",l.sexo||""),localStorage.setItem("nascimento",l.nascimento||""),localStorage.setItem("telefone",l.telefone||""),localStorage.setItem("endereco",l.endereco||"")):(alert("Você não está logado. Faça login!"),window.location.href="login.html"),document.querySelectorAll(".campo-valor").forEach(e=>e.textContent="");function f(){document.querySelectorAll(".campo-valor").forEach((o,r)=>{const a=localStorage.getItem(s[r]);a&&(o.textContent=a)})}f();const S=document.querySelector(".nome-perfil"),g=document.querySelector(".tipo-usuario");S.textContent=l.nome,g.textContent=l.tipo.charAt(0).toUpperCase()+l.tipo.slice(1),m.addEventListener("click",()=>{u.style.display="inline-block",m.style.display="none",document.querySelectorAll(".campo-valor").forEach((o,r)=>{const a=o.textContent;let t;if(s[r]==="sexo"){t=document.createElement("select"),t.className="input-edicao";const n=document.createElement("option");n.value="Masculino",n.textContent="Masculino";const c=document.createElement("option");c.value="Feminino",c.textContent="Feminino",t.appendChild(n),t.appendChild(c),t.value=a,Array.from(t.options).forEach(i=>{i.value===a&&(t.value=a)})}else t=document.createElement("input"),t.value=a,t.className="input-edicao";o.replaceWith(t)}),y()}),u.addEventListener("click",()=>{u.style.display="none",m.style.display="inline-block",document.querySelector(".header-info-pessoais");const e=document.querySelector(".btn-salvar-dados");e&&e.remove(),document.querySelector(".info-campos").querySelectorAll("input, select").forEach((r,a)=>{const t=document.createElement("span");t.className="campo-valor",t.textContent=localStorage.getItem(s[a])||"",r.replaceWith(t)})});function y(){const e=document.querySelector(".info-campos");let o=document.querySelector(".btn-salvar-dados");o&&o.remove(),o=document.createElement("button"),o.textContent="Salvar",o.className="btn-salvar-dados",o.style.marginTop="32px",o.style.width="180px",o.style.alignSelf="center",o.onclick=()=>{const r=document.querySelectorAll(".input-edicao"),a=Array.from(r).map(t=>t.value);d(a)&&(v(),u.style.display="none",m.style.display="inline-block")},e.appendChild(o)}function d(e){return/^\d{1,12}$/.test(e[0])?/^\d{2}\/\d{2}\/\d{4}$/.test(e[5])?/^\d{10,11}$/.test(e[6].replace(/\D/g,""))?e[7].trim().length<5?(alert("Endereço deve ter pelo menos 5 caracteres."),!1):e[4]!=="Masculino"&&e[4]!=="Feminino"?(alert("Selecione o sexo: Masculino ou Feminino."),!1):!0:(alert("Telefone deve conter apenas números (10 ou 11 dígitos)."),!1):(alert("Data de nascimento deve estar no formato DD/MM/AAAA."),!1):(alert("Matrícula deve conter até 12 números."),!1)}function p(e){return e=e.replace(/\D/g,""),e.length===11?`(${e.slice(0,2)}) ${e.slice(2,7)}-${e.slice(7)}`:e.length===10?`(${e.slice(0,2)}) ${e.slice(2,6)}-${e.slice(6)}`:e}function v(){const e=document.querySelectorAll(".input-edicao"),o=Array.from(e).map(n=>n.value);if(!d(o))return;e.forEach((n,c)=>{const i=document.createElement("span");i.className="campo-valor",s[c]==="telefone"?(i.textContent=p(n.value),localStorage.setItem(s[c],p(n.value))):(i.textContent=n.value,localStorage.setItem(s[c],n.value)),n.replaceWith(i)});let r=JSON.parse(localStorage.getItem("usuarioLogado"));s.forEach((n,c)=>{r[n]=o[c]}),localStorage.setItem("usuarioLogado",JSON.stringify(r));let a=JSON.parse(localStorage.getItem("usuarios"))||[];const t=a.findIndex(n=>n.nome===r.nome);t!==-1&&(a[t]=r,localStorage.setItem("usuarios",JSON.stringify(a))),document.querySelector(".btn-salvar-dados").remove(),m.style.display="inline-block"}});
